Chef-server demo
================

Overview
--------
Welcome to Erchef, the new erlang based version of chef-server  ! This
repository contains a Vagrantfile and some installation cookbooks to
set up a running chef-server so you can try it out.

Setting it up
-------------
In order to get started you need to have a copy of the latest omnibus
generated .deb for chef-server.  You can get this [here]. Then, it's
simply a matter of copying the .deb into a location that is shared with
the vm and starting vagrant

1. copy a valid open source chef omnibus installer .deb into the pkg
   sub-directory

2. export environment variable OSC_INSTALLER and set it to point at
   the omnibus installer .deb:

    > export OSC_INSTALLER=pkg/chef-server_0.10.8-194-g3f47a07-1.ubuntu.10.04_amd64.deb

3. If you want, check it has been set correctly:

    > echo $OSC_INSTALLER

4. run:

    > vagrant up

Once the vagrant run is finished, the vagrant box will be set up and open source
chef server will be running.  If there are any errors, they should be visible in
the output from the vagrant up command.

The `open-source-demo::default` recipe also sets up the `PATH` on the virtual machine
the add the command line tools for the versions of postgres, rabbit, erlang supplied in
the omnibus installer .deb. It also sets up a knife.rb for the vagrant user in `$HOME/.chef`.

You should now be able to try out knife commands against the server

Controlling the server
-----------------------
There is a single init.d style control script `chef-server-ctl`
which controls all daemons used by the chef-server. This also provides
the ability to tail all the logs produced by the individual services.

    # chef-server-ctl  help
    /opt/chef-server/embedded/bin/omnibus-ctl: command (subcommand)
    cleanse
      Delete *all* private chef data, and start from scratch.
    graceful-kill
      Attempt a graceful stop, then SIGKILL the entire process group.
    help
      Print this help message.
    hup
      Send the services a HUP.
    int
      Send the services an INT.
    kill
      Send the services a KILL.
    once
      Start the services if they are down. Do not restart them if they stop.
    reconfigure
      Reconfigure the application.
    restart
      Stop the services if they are running, then start them again.
    service-list
      List all the services (enabled services appear with a *.)
    show-config
      Show the configuration that would be generated by reconfigure.
    start
      Start services if they are down, and restart them if they stop.
    status
      Show the status of all the services.
    stop
      Stop the services, and do not restart them.
    tail
      Watch the service logs of all enabled services.
    term
      Send the services a TERM.
    test
      Run the API test suite against localhost.
    uninstall
      Kill all processes and uninstall the process supervisor (data will be
      preserved).

LICENSE
-------

Copyright 2012 Opscode, Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License"); you may
not use this file except in compliance with the License. You may obtain
a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
